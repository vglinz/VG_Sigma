title: DarkGate - Save DarkGate Loader in Temp
id: df49c691-8026-48dd-94d3-4ba6a79102a8
status: experimental
description: Detects attackers attempting to save, decrypt and execute the DarkGate Loader in C:\temp folder.
author: Tomasz Dyduch and Josh Nickels
date: 2024/03/25
references:
    - https://www.bleepingcomputer.com/news/security/hackers-exploit-windows-smartscreen-flaw-to-drop-darkgate-malware/
logsource:
    category: file_event
    product: windows
detection:
    condition: all of selection_filename_* or all of selection_image_*
    selection_filename_suffix:
        FileName|endswith:
            - .au3
            - \autoit3.exe
    selection_filename_folder:
        FileName|contains: ':\temp\'
    selection_image_suffix:
        Image|endswith:
            - .au3
            - autoit3.exe
    selection_image_folder:
        Image|contains: ':\temp\'
falsepositives: 
    - Unlikely legitimate usage of AutoIT in temp folders
level: medium
tags:
    - attack.execution
    - attack.t1059
