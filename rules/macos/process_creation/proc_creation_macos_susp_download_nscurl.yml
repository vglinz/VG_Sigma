title: Suspicious File Download With Nscurl
id: 6d8a7cf1-8085-423b-b87d-7e880faabbdf
status: experimental
description: Detects execution of the LOOBin nscurl to download files
references:
    - https://www.loobins.io/binaries/nscurl/
    - https://www.agnosticdev.com/content/how-diagnose-app-transport-security-issues-using-nscurl-and-openssl
author: Daniel Cortez
date: 2024/03/15
tags:
    - attack.defense_evasion
    - attack.command_and_control
    - attack.t1105
logsource:
    category: process_creation
    product: macos
detection:
    selection:
        Image|endswith: '/nscurl'
        CommandLine|contains:
            - '-dl'
            - '-ld'
            - '-dir'
            - '-o'
    condition: selection
falsepositives:
    - Unlikely
level: medium
